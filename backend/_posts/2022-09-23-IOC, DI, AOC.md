---
layout: post
title:  "IOC, Di, AOC"
date:   2022-09-22 20:05:42 +0900
categories: backend
---

**IOC, DI, AOPğŸ¤”  
ë¬´ìŠ¨ ë§ì´ì§€?
ì¤‘ìš”í•œ ê°œë…ì´ë‹ˆ í•œë²ˆ ë³´ê³  ê°€ì„¸ìš”ğŸ˜†**

*IOCì™€ DIëŠ” ë°€ì ‘í•œ ê´€ë ¨ì´ ìˆë‹¤*

## IOC (ì œì–´ ì—­ì „)
* ê°ì²´ ìƒì„±, ë¼ì´í”„ì‚¬ì´í´ì„ ê°œë°œìê°€ ì•„ë‹Œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ê²Œ ë§ê¸°ê²Œ ë©ë‹ˆë‹¤.
* ê°ì²´ ê´€ë ¨ ì œì–´ê¶Œì´ ì»¨í…Œì´ë„ˆì—ê²Œ ìˆë‹¤ ë³´ë‹ˆ DI(ì˜ì¡´ì„± ì£¼ì…)ì´ ê°€ëŠ¥í•˜ê²Œ ë©ë‹ˆë‹¤.

![](https://media.geeksforgeeks.org/wp-content/uploads/20210702120704/m2.png) *ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ*

### ì»¨í…Œì´ë„ˆ
* ì»¨í…Œì´ë„ˆëŠ” ê°ì²´ì˜ ë¼ì´í”„ì‚¬ì´í´ì„ ê´€ë¦¬í•˜ê³  ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ë“¤ì—ê²Œ ì¶”ê°€ì ì¸ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ê²ƒì´ë‹¤
* ê°„ë‹¨íˆ ë§í•˜ë©´ ê°ì²´ê´€ë¦¬ë¥¼ í•˜ëŠ” ê·¸ë¦‡ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤
* ì—¬ê¸°ì„œ ë§í•˜ëŠ” ê°ì²´ë¥¼ ìš°ë¦¬ëŠ” beanì´ë¼ê³  ë¶€ë¥¸ë‹¤
   
#### Bean
 * ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ëŠ” ìë°” ê°ì²´ (POJO)ë¥¼ ì˜ë¯¸
 * ì»¨í…Œì´ë„ˆì— ê³µê¸‰í•˜ëŠ” XMLíŒŒì¼ì— ì˜í•´ ìƒìƒëœë‹¤
 * ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ê°ì²´ê°€ ì§€ì •ë˜ë©´, í•´ë‹¹ ê°ì²´ëŠ” getBean() ë©”ì†Œë“œë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

#### ìŠ¤í”„ë§ Bean Scope
![](../../assets/img/backend/springbeanscope.png)
*  beanì´ ê´€ë¦¬ë˜ëŠ” ë²”ìœ„ë¥¼ ëœ»í•œë‹¤.
*  ê¸°ë³¸ì ìœ¼ë¡œ ì‹±ê¸€í†¤(Singleton)í™” ì‹œì¼œì„œ ê´€ë¦¬í•œë‹¤    

![](../../assets/img/backend/springsingleton.png)
*  singletonì€ í•œ IOC ì»¨í…Œì´ë„ˆì— ì˜¤ì§ í•˜ë‚˜ë§Œ ìƒì„±ë˜ëŠ” ê¸°ë³¸ì ì¸ scopeì´ë‹¤. 

![](../../assets/img/backend/springprototype.png)
*  prototypeì€ ëª¨ë“  ìš”ì²­ì—ì„œ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì´ë‹¤.
*  ì¦‰, í•˜ë‚˜ì˜ beanì— ë‹¤ìˆ˜ì˜ ê°ì²´ê°€ ì¡´ì¬ ê°€ëŠ¥í•˜ë‹¤.

### ì»¨í…Œì´ë„ˆ ì¢…ë¥˜
![](../../assets/img/backend/springcontainer.png)
1. Beanfactory  
  *ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì˜ì¡´ê´€ê³„ë¥¼ ë§ºì–´ì£¼ëŠ” ì—­í• ì„ í•˜ëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìµœìƒìœ„ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤*
   - Beanì„ ë“±ë¡, ìƒì„±, ì¡°íšŒ, ë°˜í™˜ ê´€ë¦¬ë¥¼ í•œë‹¤
   - Beanì„ ì¡°íšŒí•  ìˆ˜ ìˆëŠ” getBean() ë©”ì†Œë“œê°€ ì •ì˜ë˜ì–´ ìˆë‹¤. 
2. ApplicationContext
   - ê¸°ë³¸ì ì¸ Beanfactoryì˜ ê¸°ëŠ¥ì€ ê°€ì§€ê³  ìˆë‹¤
   - ìŠ¤í”„ë§ì˜ ê°ì¢… ë¶€ê°€ ê¸°ëŠ¥ì„ ì¶”ê°€ë¡œ ì œê³µí•œë‹¤.
  
#### ì°¨ì´ì 
  -   beanfactoryëŠ” ì§€ì—°ë¡œë”©(lazy-loading) ë°©ì‹ì¸ ë°˜ë©´ applicationcontextëŠ” ì‚¬ì „ë¡œë”©(pre-loading) ë°©ì‹ì´ë‹¤
  -   ì§€ì—°ë¡œë”©ì€ í•´ë‹¹ Beanì„ í˜¸ì¶œ í•  ë•Œ ë¹„ë¡œì†Œ Beanì´ ì¸ìŠ¤í„´ìŠ¤í™” ë˜ë¯€ë¡œ ë§ì€ beanì´ ë“±ë¡ë˜ì–´ ìˆë‹¤ë©´ ì‹œê°„ì´ ì˜¤ë˜ê±¸ë¦°ë‹¤.
  -   ì‚¬ì „ë¡œë”©ì€ í•´ë‹¹ beanê³¼ ê´€ë ¨ëœ ì„¤ì •ë“±ì„ ì»¨í…Œì´ë„ˆì—ì„œ ë¡œë“œ í–ˆì„ ë•Œ ì¸ìŠ¤í„´ìŠ¤í™”ê°€ ë˜ì–´ í˜¸ì¶œí•  ë•ŒëŠ” ì´ë¯¸ ì¸ìŠ¤í„´ìŠ¤í™”ê°€ ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ë°”ë¡œ í˜¸ì¶œ í•  ìˆ˜ ìˆë‹¤.

## DI (ì˜ì¡´ì„± ì£¼ì…)
* ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¡œë¶€í„° ê°ì²´ë¥¼ ì£¼ì… ë°›ëŠ” ê²ƒ (bean)
* ì§ì ‘ ìƒì„±í•˜ëŠ”ê²Œ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ì˜ì¡´ì„±ì´ ë‚®ì•„ì§€ê³  ìœ ì—°ì„±ì´ ë†’ì•„ì§„ë‹¤.

     
*ì•„ë‹ˆ ê·¼ë° ì˜ì¡´ì„±, ì˜ì¡´.. ì´ê²Œ ë¬´ìŠ¨ ë§ì´ì•¼...?*   
   
### ì˜ì¡´ ê´€ê³„
"Aê°€ Bë¥¼ ì˜ì¡´í•œë‹¤"ë¼ëŠ” ë§ì€ Bê°€ ë³€í•˜ë©´ Aë„ ì˜í–¥ì„ ë°›ëŠ”ë‹¤ëŠ” ê²ƒì´ë‹¤.
ì˜ˆë¥¼ ë“¤ì–´ ì»¤í”¼ ë ˆì‹œí”¼ê°€ ë°”ë€Œê²Œ ë˜ë©´ ë°”ë¦¬ìŠ¤íƒ€ë“¤ì€ ê·¸ì— ë”°ë¼ì•¼ í•œë‹¤. ê³ ë¡œ *ë°”ë¦¬ìŠ¤íƒ€ëŠ” ì»¤í”¼ì— ì˜ì¡´í•œë‹¤.*

### ì˜ì¡´ì„±ì´ ë‚®ì•„ì§€ëŠ” ì´ìœ 
```java
class A {
   private B b;
   public A() {
      b = new B();
   }
}
A a = new A();
```
ì´ ì½”ë“œëŠ” DIê°€ ì ìš©ë˜ì§€ ì•Šì€ ì½”ë“œì´ë‹¤.
ì—¬ê¸°ì„œ í´ë˜ìŠ¤ Bê°€ ë°”ë€ë‹¤ë©´ í´ë˜ìŠ¤ Aë„ ìˆ˜ì •ì„ í•´ì•¼í•˜ëŠ” ë¶ˆí¸í•¨ì´ ìˆë‹¤. ì¦‰ Bê°€ ë³€í•˜ë©´ Aë„ ë³€í•´ì•¼ í•˜ë¯€ë¡œ ì˜ì¡´ì„±ì´ ë†’ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

```java
class A {
   private B b;
   
   public A() {};
   public void setB (B b) {
      this.b = b;
   }
}
```
ì´ ì½”ë“œëŠ” DIê°€ ì ìš©ëœ ì½”ë“œì´ë‹¤.
í´ë˜ìŠ¤ Bê°€ ë³€í•œë‹¤ê³  í•˜ë”ë¼ë„ í´ë˜ìŠ¤ Bë§Œ ìˆ˜ì •í•˜ì—¬ í´ë˜ìŠ¤ Aì— ì „ë‹¬í•˜ë©´ ëœë‹¤. ê³ ë¡œ ì˜ì¡´ì„±ì´ ë‚®ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

### IOC, DIì˜ ì¥ì 
1. ê°ì²´ ê°„ ì˜ì¡´ì„±ì„ ì¤„ì—¬ ìœ ì—°í•œ ì½”ë“œ ì‘ì„±ì„ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤
   - DI(ì˜ì¡´ì„± ì£¼ì…)ìœ¼ë¡œ ì¸í•´ ì™¸ë¶€ì—ì„œ ê°ì²´ë¥¼ ë°›ê¸° ë•Œë¬¸ì— ì˜ì¡´ ê´€ê³„ê°€ ì¤„ì–´ë“ ë‹¤
2. ìœ ì§€ë³´ìˆ˜ì— ìš©ì´í•˜ë‹¤
   - ì½”ë“œë¥¼ ë°”ê¿”ì•¼ í•  ì¼ì´ ìƒê²¼ì„ ë•Œ ì „ì²´ê°€ ì•„ë‹Œ ì¼ë¶€ ì½”ë“œë§Œ ë°”ê¾¸ì–´ë„ í•´ê²° í•  ìˆ˜ ìˆë‹¤.
3. ì½”ë“œê°€ ë‹¨ìˆœí•´ì§„ë‹¤
   - IOCê°€ ëŒ€ë¶€ë¶„ í•´ì£¼ê¸° ë•Œë¬¸ì— ê°œë°œìëŠ” ìˆœìˆ˜ ë¡œì§ì—ë§Œ ì§‘ì¤‘ í•  ìˆ˜ ìˆë‹¤.

### 3) ìƒì„± ë°©ë²•
1. ìƒì„±ì (ê°€ì¥ ê¶Œê³ ë˜ëŠ” ë°©ë²•ì´ë‹¤)
```java
   public class {
    private B b;
    @Autowired
    public A(B b) {
        this.b = b;
    }
    public void printHello() {
        this.b.hello();
    }
   }
```    
2. í•„ë“œ ì£¼ì… (ì¢‹ì§€ ì•Šì€ ë°©ë²•ì´ë‹¤)
 > í•„ë“œ (field)ë€ í´ë˜ìŠ¤ ë‚´ë¶€ ë©¤ë²„ë¥¼ ëœ»í•œë‹¤  
```java
   public class {
    @Autowired
    private B b;
    public void printHello() {
        this.b.hello();
    }
   }
```
3. setter ë©”ì†Œë“œ
```java
   public class {
    private B ;
    
    @Autowired
    public void setB(B b) {
        this.b = b;
    }
    public void printHello() {
        this.b.hello();
    }
   }
```

*í•„ë“œ ì£¼ì…ì€ ì™œ ì¢‹ì§€ ì•Šì€ ë°©ë²•ì´ì§€...?*
> Field injection is not recommended â€¦ **Always** use constructor based dependency injection in your beans
*Alwaysë¼ê³ ...?*

### ìƒì„±ì ì£¼ì…ì˜ ì¥ì    
  * ìˆœí™˜ì°¸ì¡°ë¥¼ ì‚¬ì „ì— ë°©ì§€í•  ìˆ˜ ìˆë‹¤.   
     *  ë§Œì•½ ì½”ë“œë¥¼ ì˜ëª» ì‘ì„±í•˜ê±°ë‚˜ í•„ë“œì£¼ì… í˜¹ì€ setterì£¼ì…ìœ¼ë¡œ Aì™€ Bê°€ ì„œë¡œë¥¼ ì°¸ì¡°í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤ê³  í•˜ì. ìƒì„±ì ì£¼ì… ë°©ì‹ì´ ì•„ë‹ˆë¼ë©´ ì„œë¡œë¥¼ ê³„ì† ì°¸ì¡°í•˜ê²Œ ë˜ì–´ `stackoverflow`ê°€ ë°œìƒí•  ê²ƒì´ë‹¤. ê·¸ëŸ¬ë‚˜ ìƒì„±ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ `BeanCurrentlyInCreationException`ë¼ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©° ì‹¤í–‰ì¡°ì°¨ ë˜ì§€ ì•Šì„ ê²ƒì´ë‹¤.    
     ```java
     public class Aservice {
      @Autowired
      private BService bService;
      public void HelloA() {
         bService.HelloB();
      }
     }

     public class BService {
      @Autowired
      private AServicce aService;
      public void HelloB() {
         aService.HelloA();
      }
     }
     ```
     ì´ ê²½ìš° ìˆœí™˜ì°¸ì¡°ê°€ ìƒê²¨ `stackoveerflow` ë°œìƒ
   *  ë¶ˆë³€ì„±(Immutability)ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.
      * ìƒì„±ì ì£¼ì…ì„ ì´ìš©í•˜ë©´ DIë¥¼ í•  ë•Œ finalë¡œ ì„ ì–¸ì´ ê°€ëŠ¥í•´ì ¸ ì˜ì¡´ì„±ì„ ì£¼ì…ë°›ëŠ” ê°ì²´ê°€ ë³€í•  ì¼ì´ ì—†ì–´ì§„ë‹¤.
   *  í•„ìˆ˜ì ì¸ ì˜ì¡´ì„±ì´ ì—†ë‹¤ë©´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ì—†ë„ë¡ ê°•ì œí•˜ê³  ìˆë‹¤.
      ```java

      ```
   * í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰½ë‹¤.
     * í•„ë“œ ì£¼ì…ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ê°œë°œìê°€ ì§ì ‘ í•„ë“œì— ì£¼ì…ì„ í•  ìˆ˜ ì—†ê²Œ ëœë‹¤. springì´ ì•Œì•„ì„œ ì£¼ì…ì„ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.


<hr>

### ì°¸ì¡°
-  https://gmlwjd9405.github.io/2018/11/10/spring-beans.html
-  https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-scopes
-  https://shanepark.tistory.com/368

<hr>
https://shanepark.tistory.com/368
https://dev-coco.tistory.com/70#%EC%--%B-%EB%--%A-%--%EC%A-%BC%EC%-E%--%--%EB%B-%A-%EC%-B%-D%EC%-D%--%--%EC%--%AC%EC%-A%A-%ED%--%--%EB%-A%--%EA%B-%-C%--%EC%A-%-B%EC%-D%--%EA%B-%-C%-F
https://madplay.github.io/post/why-constructor-injection-is-better-than-field-injection